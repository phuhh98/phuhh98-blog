---
import ListPosts from "@/components/ListPosts";
import TitlePage from "@/components/TitlePage";
import BaseLayout from "@/layouts/BaseLayout";
import { ContentRetriever } from "@/utils";

export async function getStaticPaths() {
  const tags = await ContentRetriever.getTags();

  return tags.items.map((tag) => ({
    params: { tag: tag.fields.title },
    props: { tag: tag.fields.title },
  }));
}

type Props = {
  tag: string;
};

const { tag } = Astro.props;

const posts = await ContentRetriever.getPostByTag(tag);
---

<BaseLayout title={tag}>
  <TitlePage title={tag} />
  <ListPosts posts={posts} />
</BaseLayout>
